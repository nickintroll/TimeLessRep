{% extends 'base2.html' %}
{% load static %}

{% block content %}
	{% if note %}
		<div id="note">
			<div id="note-closer">
				x
			</div>
			<h2>
				Your request was saved
			</h2>
			<div>
				Our service got notification and we will contact you as soon as we can. Thank you for choosing us.
			</div>
		</div>
	{% endif %}
<div class="content__title_back" style="
background: linear-gradient( rgba(0, 0, 0, 0.1) 70%, rgba(0, 0, 0, 0.1) ), url({% static 'imgs/photo_2023-02-16_22-54-12.jpg' %}); 	
background-position: center;
background-repeat: no-repeat;
background-size: cover;
min-height: 50vh;
position: relative;
text-shadow: 0px 0px 5px black;
filter: saturate(1.5);
margin-bottom: 2rem
">
</div>

        <div class="content-width">
            <div class="two-columns destroy-grid">
                <div>
                    <div class="">
                        <h1>
							{{ texts.texts.dubai_visas.text }}
                        </h1>
                        <br>
                        <div>
							{{ texts.texts.dubaivisa_exp.text|linebreaks }}

						</div>
                        <br>
                        <div class="inline-bastards tricky-but">
                            <div class="button info-button">
                                {{ texts.texts.learn_more.text }}
                            </div> 
                            <div class="button agree-button">
                                {{ texts.texts.contact_us.text }}
                            </div> 
                        </div>
                        <br>
    <br>
    <br>

                    </div>    
                </div>
                
                <div>
                    <h2>
						{{  texts.texts.calculate_price_for_fam_dubai.text }}
                    </h2>                    
                    <br>
                    <div>
						<form method="post">
                        <div class="inline-bastards">
							{{ form.visa_duration }}
                        </div>
						<div class="inline-bastards" style="margin-bottom: .5rem;">
                            <div class="button">	
                                <span id="one_person">{{ texts.texts.grown_person.text }}</span>
                            </div>
                            <div class="button">
                                <span id="kid_person">{{ texts.texts.Child_under_18yo.text }}</span>
                            </div>
                        </div>

                        <div class="gray-back wide-thing " id="culc-people">
							{{ texts.texts.noone.text }}
							
                        </div>
						<div class="inline-bastards">
                             <h5>
								{{ texts.texts.we_are_a_family.text }}
							</h5>
							<input type="checkbox" id="is_family" style="margin-left: .4rem;">
                        </div>
                        <h3>
                            {{ texts.texts.total.text }}: <span id="culc_results"> 0</span> aed
                        </h3>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<br>
<br>

<div class="content__title_back" style="
	background: linear-gradient( rgba(0, 0, 0, 0.5) 70%, rgba(0, 0, 0, 0.5) ), url({% static 'imgs/dubai-skyline-at-dusk-jpg_header-144981.avif' %}); 	
	background-position: bottom;
    background-repeat: no-repeat;
    background-size: cover;
    min-height: 50vh;
    position: relative;"
>
	<div class="total-centered">
		<h2 style="color: white;">
			{{ texts.texts.your_request.text }}
		</h2>
		<a href="{% url 'main:my_requests' %}" style="color: rgb(113, 213, 246);">{{  texts.texts.already_have_request.text }}</a>
		<br>
		<br>
		<div style="color: rgb(225, 225, 225);">
			{{ texts.texts.dubai_your_request_exp.text|linebreaks }}
		</div>
	</div>
</div>
<br>
<br>
<br>
<div class="content-width">
	<div class="centered"style="max-width: 70ch;">
		<h2>
			{{ texts.texts.dubai_change_visa.text }}
		</h2>
		<div>
			{{ texts.texts.dubai_change_visa_exp.text }}
		</div>
	</div>
	<br>
	<div class="centered">
		<div class="inline-bastards">
			<img src="{% static 'imgs/van.png' %}" alt="" style="height: 200px; width: 350px; margin-right: 1rem;">
			<img src="{% static 'imgs/visa_approved.jpg' %}" alt="" style="height: 200px; width: 350px;">
		</div>
	</div>
</div>    

<br>
<br>
<br>

<div class="content-width">
	<div class="two-columns destroy-grid highlight-point">
		<div class="two-columns destroy-grid">
			<div>
				<div>
					First name
				</div>
				{{ form.first_name }}		
				<div>
					Last name
				</div>
				{{ form.last_name }}
			</div>
			<div>
				<div>
					<div>
						{{ texts.texts.contact_information.text }}
					</div>
					{{ form.contact_information }}
				</div>
			</div>
			<div>
				<div>
					<div>
						{{ texts.texts.passport_series.text }}
					</div>
					{{ form.passport_series }}
				</div>		
			</div>
		</div>
		<div>
			<div class="two-columns destroy-grid">
				<div style="padding-right: 1rem;">
					<div>
						{{ texts.texts.my_passport_from.text }}
					</div>
					{{ form.passport_registered_at  }}
				</div>
				<div>
					<div>
						{{ texts.texts.im_located_in.text }}
					</div>
					{{ form.now_located_in }}
				</div>

				<!--  -->
				<div>
					<div>
						{{ texts.texts.getting_passport_date.text }}
					</div>
					{{ form.passport_open_date }}
				</div>
				<div>
					<div>
						{{ texts.texts.passport_expiration_date.text }}
					</div>
					{{ form.passport_closure_date }}
				</div>	
			</div>
		</div>
		<div>

		</div>
		<div class="two-columns">			
			<div>

			</div>
			<div>
				<input type="submit" value="{{ texts.texts.Confirm.text }}" id="confirm-but" class="save-bitton button">	
			</div>
		</div>
	</div>
	

</div>
{% csrf_token %}
</form>	


{% endblock %}

{% block scripts %}
<script>
	var field = document.getElementById('culc-people');
	var person_but = document.getElementById('one_person');
	var kid_but = document.getElementById('kid_person');
	var result_place = document.getElementById('culc_results');
	var is_family = document.getElementById('is_family');
	var visa_type = document.getElementById('id_visa_duration');

	var calculte = function() {
		var result = 0;
		let visa = visa_type.value;

		for (let child of field.children) {
			if (child.id === 'one_person') {
				if (visa === 'Tourist visa(30 days)') {
					result += 600;
				} else if (visa === 'Tourist visa(60 days)') {
					result += 900;
				} else if (visa === 'Multivisa(30 days)') {
					result += 900;
				} else if (visa === 'Multivisa(60 days)') {
					result += 1300;	
				}	
			};
			if (child.id === 'kid_person') {
				if (visa === 'Tourist visa(30 days)') {
					if (is_family.checked) {
						result += 400;
					} else {
						result += 600;
					}
				} else if (visa === 'Tourist visa(60 days)') {
					if (is_family.checked) {
						result += 700;
					} else {
						result += 900;
					}
				} else if (visa === 'Multivisa(30 days)') {
					if (is_family.checked) {
						result += 700;
					} else {
						result += 900;
					}
				} else if (visa === 'Multivisa(60 days)') {
					if (is_family.checked) {
						result += 1100;
					} else {
						result += 1300;
					}
				}	
			};
			
		};
		result_place.innerHTML = result;
	};

	var remove_item_from_culc = function(event, par_id){
		// let del_target = document.getElementById('culc-people').getElementById(par_id);
		// console.log(del_target)
		field.removeChild(event.target);
	
		calculte();

		if (field.innerHTML.length === 0) {
			field.innerHTML = '{{ texts.texts.noone.text }}'
		};
	};

	var add_item_to_culc = function(e) {		
		let item = '<div class="removeable" id="'+e.target.id+'" onclick="remove_item_from_culc(event, this.id)">' + e.target.innerHTML+ '</div>';
		if (field.innerHTML.trim() === '{{ texts.texts.noone.text }}'){
			field.innerHTML = item;
		} else{
			field.innerHTML += item;
		};
		calculte();
	};

	person_but.onclick = add_item_to_culc;
	kid_but.onclick = add_item_to_culc;
	visa_type.onchange = calculte;
	is_family.onchange = calculte;

</script>

<script>
	document.getElementById('note-closer').onclick = function() {
		document.getElementById('note').style['display'] = 'none'
	}
</script>
{% endblock %}